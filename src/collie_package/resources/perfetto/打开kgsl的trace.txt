打开kgsl的trace
adb root
adb remount
adb shell setenforce 0
adb shell "echo 0 > /sys/kernel/tracing/tracing_on"
adb shell "echo '' > /sys/kernel/tracing/set_event"
adb shell "echo '' > /sys/kernel/tracing/trace"
adb shell "echo 40960 >/sys/kernel/tracing/buffer_size_kb"
adb shell "echo kgsl:* >> /sys/kernel/tracing/set_event"
adb shell "echo dma_fence:* >> /sys/kernel/tracing/set_event"
adb shell "echo 0 > /sys/kernel/tracing/events/kgsl/kgsl_regwrite/enable"
adb shell "echo 1 > /sys/kernel/tracing/tracing_on"
adb shell "echo 1 > /sys/kernel/tracing/events/sde/enable"
adb shell "echo 1 > /sys/kernel/tracing/events/sde/tracing_mark_write/enable"

添加权限
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/adreno_cmdbatch_done/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/adreno_cmdbatch_fault/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/adreno_cmdbatch_queued/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/adreno_cmdbatch_ready/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/adreno_cmdbatch_recovery/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/adreno_cmdbatch_retired/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/adreno_cmdbatch_submitted/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/adreno_cmdbatch_sync/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/adreno_drawctxt_invalidate/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/adreno_drawctxt_sleep/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/adreno_drawctxt_switch/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/adreno_drawctxt_wait_done/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/adreno_drawctxt_wait_start/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/adreno_drawctxt_wake/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/adreno_gpu_fault/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/adreno_hw_preempt_clear_to_trig/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/adreno_hw_preempt_comp_to_clear/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/adreno_hw_preempt_token_submit/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/adreno_hw_preempt_trig_to_comp/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/adreno_hw_preempt_trig_to_comp_int/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/adreno_ifpc_count/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/adreno_preempt_done/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/adreno_preempt_trigger/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/adreno_sp_tp/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/dispatch_queue_context/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/gmu_ao_sync/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/gmu_event/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/gpu_frequency/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_a3xx_irq_status/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_a5xx_irq_status/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_active_count/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_aux_command/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_bcl_clock_throttling/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_bus/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_buslevel/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_clk/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_clock_throttling/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_constraint/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_context_create/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_context_destroy/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_context_detach/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_drawobj_timeline/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_fire_event/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_gen7_irq_status/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_gmu_oob_clear/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_gmu_oob_set/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_gmu_pwrlevel/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_gpubusy/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_hfi_receive/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_hfi_send/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_irq/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_issueibcmds/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_mem_add_bind_range/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_mem_alloc/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_mem_free/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_mem_map/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_mem_mmap/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_mem_remove_bind_range/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_mem_sync_cache/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_mem_sync_full_cache/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_mem_timestamp_free/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_mem_timestamp_queue/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_mem_unmapped_area_collision/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_mmu_pagefault/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_msg/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_pagetable_destroy/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_pool_add_page/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_pool_alloc_page_system/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_pool_free_page/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_pool_get_page/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_pool_try_page_lower/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_pwr_request_state/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_pwr_set_state/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_pwrlevel/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_pwrstats/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_rail/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_readtimestamp/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_reclaim_memdesc/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_reclaim_process/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_register_event/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_thermal_constraint/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_timeline_alloc/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_timeline_destroy/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_timeline_fence_alloc/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_timeline_fence_release/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_timeline_signal/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_timeline_wait/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_user_pwrlevel_constraint/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_waittimestamp_entry/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/kgsl_waittimestamp_exit/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/syncpoint_fence/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/syncpoint_fence_expire/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/syncpoint_timestamp/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/kgsl/syncpoint_timestamp_expire/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/sde/tracing_mark_write/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/sde/sde_cmd_release_bw/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/sde/sde_evtlog/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/sde/sde_perf_crtc_update/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/sde/sde_perf_set_qos_luts/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/sde/sde_perf_uidle_status/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/sde/sde_encoder_underrun/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/sde/sde_perf_calc_crtc/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/sde/sde_perf_set_ot/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/sde/sde_perf_uidle_cntr/enable"
adb shell "chmod 0664 /sys/kernel/tracing/events/sde/sde_perf_update_bus/enable"